
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Go 语言实战（6）：命令行程序（1） | 存档Save&amp;Load</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="看到别人的好作品，像画作、模型还是代码，我们第一反应可能是感叹结构复杂、技巧精湛，然后紧接着冒出一个想法：太难了，我做不到。">
<meta property="og:type" content="article">
<meta property="og:title" content="Go 语言实战（6）：命令行程序（1）">
<meta property="og:url" content="https://jaycechant.info/2020/golang-in-action-day-6/index.html">
<meta property="og:site_name" content="存档Save&Load">
<meta property="og:description" content="看到别人的好作品，像画作、模型还是代码，我们第一反应可能是感叹结构复杂、技巧精湛，然后紧接着冒出一个想法：太难了，我做不到。">
<meta property="og:image" content="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png">
<meta property="og:updated_time" content="2020-10-25T13:37:44.978Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Go 语言实战（6）：命令行程序（1）">
<meta name="twitter:description" content="看到别人的好作品，像画作、模型还是代码，我们第一反应可能是感叹结构复杂、技巧精湛，然后紧接着冒出一个想法：太难了，我做不到。">
<meta name="twitter:image" content="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png">
  
    <link rel="alternative" href="/atom.xml" title="存档Save&amp;Load" type="application/atom+xml">
  
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
</head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">存档Save&amp;Load</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">存档意味着放下包袱，搞砸了不过回来读档</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/list">List</a>
        
          <a class="main-nav-link" href="https://github.com/JayceChant">Github</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
          <a class="main-nav-link" href="/sitemap.xml">Sitemap</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
        
      </nav>
      
      <div id="search-form-wrap">
        <form action="" accept-charset="utf-8" class="search-form">
          <input id="searchtext" type="search" name="q" maxlength="20" class="search-form-input" placeholder="Search" onkeypress="if(event.keyCode==13){document.getElementById('searchsub').click();return false;}">
          <input id="searchsub" type="submit" value="" class="search-form-submit" onclick="window.open('https://global.bing.com/search?&amp;q=site:jaycechant.info '+document.getElementById('searchtext').value, '_blank')">
        </form>
      </div>
      
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main"><article id="post-golang-in-action-day-6" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/golang-in-action-day-6/" class="article-date">
  <time datetime="2020-10-18T16:39:39.000Z" itemprop="datePublished">2020-10-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Go-语言实战/">Go 语言实战</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Go 语言实战（6）：命令行程序（1）
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>看到别人的好作品，像画作、模型还是代码，我们第一反应可能是感叹结构复杂、技巧精湛，然后紧接着冒出一个想法：太难了，我做不到。</p>
<a id="more"></a>
<p>这往往是因为我们对相应的领域了解不够，只看到复杂的结果，对如何通向目的地毫无概念。如果了解如何分解任务，到最简单的步骤为止，还有从最简单能看到反馈的雏形开始，逐步改善，普通人也能做出复杂的作品，最多时间比有天赋的人多花一些。</p>
<p>这一期开始，我们会花几期的时间，逐步地尝试改善一个命令行程序。</p>
<p>如果是从这篇文章才开始看的新手，建议先简单浏览前几期的内容。当然，你也可以完成第一期的环境搭建之后直接跳到这期，在实际遇到问题时再去查看具体的内容。</p>
<ol>
<li><a href="../golang-in-action-day-1/">初识</a></li>
<li><a href="../golang-in-action-day-2/">常量与变量</a></li>
<li><a href="../golang-in-action-day-3/">类型</a></li>
<li><a href="../golang-in-action-day-4/">运算符</a></li>
<li><a href="../golang-in-action-day-5/">流程控制</a></li>
</ol>
<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>我们从一个命令行程序开始。</p>
<h3 id="命令行界面"><a href="#命令行界面" class="headerlink" title="命令行界面"></a>命令行界面</h3><p>命令行界面（CLI，Command Line Interface），又叫字符用户界面 （CUI，Character User Interface），区别于图形用户界面（GUI，Graphic User Interface）。GUI 就像在国外不用学当地语言，有一份我们能看懂的、甚至有图片的菜单供选择，指一下就有结果，无需语言交流。而在 CLI 里，人和机器通过标准输入输出（可以简单理解为打字）进行交互：你必须通过命令准确地告诉系统你想干嘛，然后系统执行并把结果打在屏幕上。你必须得先知道系统接受什么命令。如果输入命令以外的东西，系统只能告诉你『我听不懂』。</p>
<p>GUI 当然要比傻傻等着你打字的黑窗友好，也是日常使用的主流。但在方便之余，你无法提出菜单以外的细致要求，执行菜单上没有显示的操作。同一个动作（如点一下菜单第二项），结果高度依赖当前的菜单显示，你必须等菜单显示完成才能接着『交互』，而不能一口气直接下达想要的一系列动作指令。这就好像你明明想好了要干什么，却不能说话，非要等下属慢慢翻到那页菜单。相比之下，CLI 可以一口气接受一系列精确的指令。所以即使在图形界面的系统中，命令行也没有被遗弃，甚至还在不断地加强。</p>
<p>从开发的角度说，图形界面开发的门槛反而比较高，命令行程序因为没有图形界面，减少了很多工作量，可以把精力集中在核心的功能上，适合练手。</p>
<h3 id="函数签名和函数类型"><a href="#函数签名和函数类型" class="headerlink" title="函数签名和函数类型"></a>函数签名和函数类型</h3><p>别误会，我没有打算详细介绍函数。</p>
<p>在实际的开发中，自然会接触函数的用法。在写出优雅强大的函数之前，我们可以先调用标准库或第三方包里别人写好的函数，并从中学习。</p>
<p>要正确使用函数，我们需要查看文档，看懂函数签名和注释，有些还会有例子，就像看说明书。如果想学习实现，则要进一步看源码。</p>
<p>以经常用的 <code>fmt.Println</code> 为例。</p>
<p>可以在 <a href="https://pkg.go.dev" target="_blank" rel="external">https://pkg.go.dev</a> 上搜索 <code>fmt</code> 包，找到 <code>Println</code> 这个函数，内容是这样的：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">Println</span><span class="params">(a ...<span class="keyword">interface</span>&#123;&#125;)</span> <span class="params">(n <span class="keyword">int</span>, err error)</span></span></div></pre></td></tr></table></figure>
<blockquote>
<p>Println formats using the default formats for its operands and writes to standard output. Spaces are always added between operands and a newline is appended. It returns the number of bytes written and any write error encountered.</p>
</blockquote>
<p>Example Code:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">	<span class="string">"fmt"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	<span class="keyword">const</span> name, age = <span class="string">"Kim"</span>, <span class="number">22</span></div><div class="line">	fmt.Println(name, <span class="string">"is"</span>, age, <span class="string">"years old."</span>)</div><div class="line"></div><div class="line">	<span class="comment">// It is conventional not to worry about any</span></div><div class="line">	<span class="comment">// error returned by Println.</span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Kim is 22 years old.</div></pre></td></tr></table></figure>
<blockquote>
<p>注：pkg.go.dev 从 19 年起取代了 godoc.org 成为了 Go 语言的文档网站，上面不仅可以搜索到标准库，所有被缓存了的第三方 module 也都能搜到。（go module 默认会先向 proxy 请求第三方包，proxy 发现尚未缓存就会先获取缓存再返回。换言之，几乎所有公开的有人请求的 module 都可以搜到。）</p>
</blockquote>
<hr>
<p>函数签名、注释、例子还有例子的输出，是标准的文档构成。</p>
<blockquote>
<p>注：文档里的实际上是函数原型（prototype），但要确认的主要是签名信息。</p>
</blockquote>
<p><code>Println</code> 不是讨论重点，注释和例子就不展开了。主要介绍一下函数签名。</p>
<p>函数签名（function signature）定义了函数的输入（参数列表）和输出（返回值列表）。它本质上是函数开发者和调用者之间的契约，包含函数的关键信息：参数的类型、个数和顺序，返回值的类型、个数和顺序。调用者通过它了解调用时要提供什么，以及在调用完成后会得到什么。（当然，按签名调用还是有可能出现逻辑上的错误，开发者需要在注释中进一步说明注意事项。）函数名、参数名、返回值名可以出现在签名里也可以省略，<strong>命名信息对签名来说并不重要</strong> 。</p>
<p>最简单的函数签名是这样的：<code>(参数列表) (返回值列表)</code>。签名信息前面加上 <code>func</code> 关键字就成了函数类型（type）字面量，再加上函数名就成了函数原型（prototype），再加上函数体 <code>{/*代码实现*/}</code> 就变成完整的函数。实际使用中，虽然函数签名是关键，但命名能帮助我们区分函数、参数和返回值，还能从命名中推测用途，所以很多函数签名其实是带着命名的类型字面量或函数原型的形式。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 单纯的签名信息</span></div><div class="line">(<span class="keyword">int</span>, <span class="keyword">int</span>) (<span class="keyword">int</span>, error)</div><div class="line"><span class="comment">// 函数类型字面量，但不细究的话，也可以叫函数签名</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">int</span>, error)</span></span></div><div class="line">// 函数原型，有时这个也叫函数签名</div><div class="line"><span class="title">func</span> <span class="title">Count</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">int</span>, error)</span></div><div class="line">// 完整的函数</div><div class="line"><span class="title">func</span> <span class="title">Count</span><span class="params">(start <span class="keyword">int</span>, end <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">int</span>, error)</span> &#123;</div><div class="line">    <span class="comment">// 有引用到的参数需要命名。一般函数没有多余的参数，所以参数都是命名的。</span></div><div class="line">    count := <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> i := start; i &lt; end; i++ &#123;</div><div class="line">        <span class="comment">// ...</span></div><div class="line">        count++</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> count, <span class="literal">nil</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Go 里面函数也是一种类型，签名相同的函数就被认为是同一个类型。下面的代码是合法的：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> f <span class="function"><span class="keyword">func</span><span class="params">(a <span class="keyword">int</span>, b <span class="keyword">int</span>)</span> <span class="params">(c <span class="keyword">int</span>)</span> = <span class="title">func</span><span class="params">(x <span class="keyword">int</span>, y <span class="keyword">int</span>)</span> <span class="params">(z <span class="keyword">int</span>)</span></span> &#123; <span class="keyword">return</span> x + y &#125;</div><div class="line"><span class="keyword">var</span> f2 <span class="function"><span class="keyword">func</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span> <span class="title">int</span> = <span class="title">f</span></span></div></pre></td></tr></table></figure>
<p>实际上，真正的签名信息是 <code>(int, int) int</code> ，<code>func</code> 关键字和各种命名 <code>a</code>, <code>b</code>, <code>c</code>, <code>x</code>, <code>y</code>, <code>z</code> 都可以省略，有没有命名、命名是否相同，不影响它们是同一个类型。（函数的参数名 <code>x</code> 和 <code>y</code> 在函数体没有引用时也可以省略，例如 <code>func(int, int) int {return 0}</code> 。）</p>
<p>无论是哪一种形式，关注的要点都是参数列表和返回值列表。知道以下几点规则，你就可以读懂函数签名：</p>
<ul>
<li><p>跟其它 C 家族语言返回值类型在前、没有关键字不同（C 语言：<code>int myFunc(int a)</code>），Go 以关键字开头，函数名和参数列表在返回值列表前面。</p>
<p>  （顺序：关键字 - 函数名 - 参数列表 - 返回值列表。）</p>
</li>
<li><p>因为允许多返回值，参数和返回值都是列表。其中参数列表外面的括号不能省略，即使参数列表为空；而返回值列表如果为空或者只有一个匿名返回值，可以省略括号。</p>
<p>  （区分参数还是返回值：第一个括号里的是参数，右边剩下的是返回值。Go 没有类似 <code>void</code> 的关键字，没有返回值时，返回值部分直接为空。）</p>
</li>
<li><p>连续多个相同类型的命名参数或返回值，可以一起声明，<code>(a, b, c int, s string)</code> 等价于 <code>(a int, b int, c int, s string)</code> 。（要看懂这种写法，但不推荐这样写。这样写在增减参数和调整参数顺序时，容易出错，会把类型张冠李戴。）</p>
</li>
</ul>
<h4 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h4><p>Go 支持可变参数（variadic arguments）。具体声明形式是，在类型前面加上三个句点 <code>...</code> ，表示可以接受 0 到多个该类型的参数。例如 <code>Println</code> 的 <code>(a ...interface{})</code> 表示可以接受任意个空接口类型的值作为参数。</p>
<blockquote>
<p>注：空接口方法列表为空，意味着任意类型都满足空接口，任意类型都可以作为实参传递给函数。相当于 Java 里用 Object 作为参数类型。</p>
</blockquote>
<p>调用时：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 可以没有参数，只输出一个换行符</span></div><div class="line">fmt.Println()</div><div class="line"><span class="comment">// 可以 3 个 int 型字面量</span></div><div class="line">fmt.Println(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line"><span class="comment">// 不同类型混合着来</span></div><div class="line"><span class="comment">// 允许不同类型是因为用了空接口类型，数量可以为任意个才是可变参数的关键</span></div><div class="line">fmt.Println(<span class="string">"院子里有"</span>, <span class="number">1</span>, <span class="string">"棵枣树，另"</span>, <span class="number">1</span>, <span class="string">"棵也是枣树？"</span>, <span class="literal">true</span>)</div></pre></td></tr></table></figure>
<p>函数最多只能声明一个 <strong>可变参数</strong> ，而且只能是最后一个参数（可变参数放中间，后面的参数就很难对得上号了）。</p>
<p>可变参数实际上是一个语法糖，传给可变参数的一系列值被打包成了一个对应类型的切片，供函数内部引用。<code>Println</code> 的参数在函数内部相当于 <code>(a []interface{})</code> 。不过今天不讨论函数的实现，只讨论调用。</p>
<p>既然可变参数实际上变成了一个切片，如果调用方刚好有一个同类型切片 <code>s</code>，可以直接拿来当实参吗？</p>
<p>不能。可变参数调用时要求传入的是一个一个对应类型的值，传相应的切片类型不符。难道只能 <code>(s[0], s[1], s[2])</code> 这样一个个地传参吗？如果切片有一百个元素呢……</p>
<p>这时有另外一个语法糖，在实参后面同样加上 <code>...</code> ，就会产生类似 Python 解包（unpack）的效果。当然，只是像，实际上是告诉函数这是一个切片，可以直接复制给可变参数，并没有解包再打包的操作。</p>
<p><code>...</code> 的位置很容易搞混：可变参数（形参）的声明放在前面，给实参『解包』放在后面。</p>
<h2 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h2><p>铺垫了一些背景知识，下面开始动手。</p>
<h3 id="需求背景"><a href="#需求背景" class="headerlink" title="需求背景"></a>需求背景</h3><p>准备这期内容时，我在读者中间征集过日常找不到软件工具的小需求，作为实战项目的选题。最后也没找到合适选题，这期先用我曾经遇到的需求做例子。后续大家想到什么需求，还是可以留言，也许就用在下一个项目上。</p>
<p>这个需求很简单：<strong>排序</strong>。源自我第一份工作时，开发之余偶尔帮项目做版本管理。VCS 用的 P4，所有手机型号的项目，在同一个代码库的同一棵源码树上，通过分支和特性开关区分型号。优点是，跨型号共性问题，只要在源头上修改一次，随着代码定期集成到各分支，都会修复，避免重复劳动和遗漏型号。缺点是，针对某些型号的修改，如果隔离没做好，会影响无关的型号。</p>
<p>送测和正式发布的编译，为避免引入不确定的提交，采用基线（base）+ 追加提交的方式。会选择一个经过验证的提交作为 base，到 base 为止的所有修改都参与编译；base 之后的提交，往往都不太确定，遇到必须包含的提交，就要添加到追加提交里，编译时会将这些提交当作补丁按顺序应用到代码上（相当于临时 cherrypick）。但这个顺序，不是提交顺序，而是填写顺序。假如提交 A 修复问题 1 同时引起问题 2，之后提交 B 对同一个地方做修改修复问题 2。那么填写时必须按照 A 到 B 的顺序，否则 B 的修改会被 A 覆盖，问题 2 将仍然存在。</p>
<p>每次编译之前，在内网公布 base，模块负责人根据 base 回复需要追加的提交，然后管理员就得到了一堆提交号。P4 的提交号是自增序列号，所以只要将它们升序排列，就能保证先后顺序。</p>
<p>交流大概是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">管理员：本次编译，base 为 123456</div><div class="line">驱动组：133297 修复兼容性问题</div><div class="line">电源管理组：167834 修正功耗计算</div><div class="line">图形组：123467 调整刷新缓存</div><div class="line">系统组：145683 修改进程管理策略</div><div class="line">......</div></pre></td></tr></table></figure>
<p>管理员经过整理，得到了 <code>123467,133297,145683,167834</code> 作为编译的参数。提交少的时候，人工处理一下就完了。但如果因为某些原因无法提高 base，后续的补丁却源源不断，提交可能会积累到过百，这时人工确认就又累又容易出错了。于是我当时就写了一个命令行工具来处理这么一个简单的需求。</p>
<p>为什么不直接用 Excel 呢？首先是 Office 启动慢，特别在已经打开一系列开发工具的前提下；其次需要将提交录入，排序之后还得想办法导出，又增加了工作量。Linux 底下倒是有一个 <code>sort</code> 命令，但是当时我在用 Windows。对于这种简单的需求，自己开发不仅工作量不大，遇到需求有变化时还很容易按需调整。</p>
<p>当时还没接触 Go，用的 C 开发。现在当然要用 Go 来练习。</p>
<blockquote>
<p>注：考虑到篇幅有限，下面只展示代码的关键部分，需要补足剩余的代码成分才能编译运行。</p>
<p>关于如何初始化一个项目，以及项目的基本结构，请参考第一期的内容。如果还有问题，欢迎在留言区或者加入交流群提问。</p>
</blockquote>
<h3 id="小目标"><a href="#小目标" class="headerlink" title="小目标"></a>小目标</h3><p>一开始不要设太高的期待，先让程序可以跑起来，这样才能基于运行的反馈，一步步改善程序。为此先把需求简化到最简：从标准输入获取提交号，排好序之后，输出到标准输出，用英文逗号隔开（格式要方便后续使用，P4 要求的格式就是用逗号隔开的提交号，你也可以根据自己的需要调整）。</p>
<p>假定把这个程序叫 <code>gosort</code> ，那么用起来大概是这样的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; gosort 133297 167834 123467 145683</div><div class="line">123467,133297,145683,167834</div></pre></td></tr></table></figure>
<p>这个程度很简单，调用标准库就可以做到。</p>
<h3 id="命令行参数"><a href="#命令行参数" class="headerlink" title="命令行参数"></a>命令行参数</h3><p><code>gosort 133297 167834 123467 145683</code> 这一串，对命令行环境来说，是（带参数的）命令，会根据开头的命令，传递给名为 <code>gosort</code> 的程序；而对 <code>gosort</code> 程序来说，这一串则是命令行参数。<strong>注意，命令（程序名）也是参数的一部分</strong>。有些程序实现了多种功能，对外链接到不同文件名，会根据传进来的程序名称不同，执行不同的动作。最典型的例子是 <code>busybox</code> ，它以单一可执行文件，提供了一个包含超过两百个命令的 unix 工具集合，被称为嵌入式 Linux 的瑞士军刀。</p>
<p>不像其它 C 家族语言，Go 的命令行参数不是作为 <code>main</code> 函数的参数传递的，而是通过 <code>os</code> 包的 <code>Args</code> 变量获取。<code>os</code> 包初始化时会获取参数并储存在 <code>Args</code> 中，它是一个字符串切片 <code>[]string</code>。前面介绍过查询文档的方法，想了解更多可以自行到 pkg.go.dev 查询；标准库源码则在 Go 的安装目录的 <code>src</code> 目录下，按包名储存，另外大多数 IDE 都支持源码的跟踪跳转（一般的操作，是对着 <code>os.Args</code> 按 <code>Ctrl</code> + 鼠标左键）。</p>
<p>先读取命令行参数然后直接输出看看效果：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 包声明、import 语句已省略，请自行补充</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    fmt.Println(os.Args)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 先编译</span></div><div class="line">&gt; go build</div><div class="line"><span class="comment"># 后执行。程序名请替换成你自己的 module 名。Linux 下本地执行需要加 ./</span></div><div class="line">&gt; gosort 133297 167834 123467 145683</div><div class="line"><span class="comment"># 以下是输出，我们先不要纠结方括号</span></div><div class="line">[gosort 133297 167834 123467 145683]</div><div class="line"></div><div class="line"><span class="comment"># 当然我们也可以直接 go run</span></div><div class="line">&gt; go run main.go 133297 167834 123467 145683</div><div class="line"><span class="comment"># go run 本质上是在临时目录编译后执行，所以输出的程序名里带有临时目录信息</span></div><div class="line">[C:\Users\Jayce\AppData\Local\Temp\go-build065892054\b001\exe\main.exe 133297 167834 123467 145683]</div></pre></td></tr></table></figure>
<h3 id="改善"><a href="#改善" class="headerlink" title="改善"></a>改善</h3><p>这里我们需要改善几个问题：</p>
<ul>
<li>在这个程序里，程序名用不上，留在切片里还会参与后续的排序。</li>
<li><code>os.Args</code> 是第三方包的包级变量，尽量不要直接在上面排序。虽然命令行参数在这个程序里暂时没有别的用处，但直接修改公共变量仍是一个坏习惯。</li>
<li>方括号其实是输出切片内容时的格式，最终结果不需要方括号，要想办法去掉。</li>
<li>不仅要去掉切片的方括号，还要加上英文逗号。</li>
</ul>
<p><code>main</code> 函数里的代码改进如下（这里就不再执行，请自己执行，查看改动后的输出）：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="comment">// n 是除了程序名以外的参数数量</span></div><div class="line">    <span class="comment">// len() 是内置函数，获取集合（这里是切片）的大小</span></div><div class="line">    n := <span class="built_in">len</span>(os.Args) - <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="comment">// 创建一个大小为 n 的切片</span></div><div class="line">    nums := <span class="built_in">make</span>([]<span class="keyword">string</span>, n)</div><div class="line"></div><div class="line">    <span class="comment">// copy() 也是内置函数，把除程序名以外的参数拷贝到新切片</span></div><div class="line">    <span class="comment">// [1:] 是从下标 1 开始重新切片，跳过下标 0（即程序名）</span></div><div class="line">    <span class="comment">// 重新切片返回的新切片，跟原切片指向同一个底层数组，修改会互相影响，重新切片后还是要拷贝</span></div><div class="line">    <span class="built_in">copy</span>(nums, os.Args[<span class="number">1</span>:])</div><div class="line"></div><div class="line">    <span class="comment">// 把参数逐个输出，其中前面的参数后面跟逗号，最后一个参数后面跟换行</span></div><div class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n<span class="number">-1</span>; i++ &#123;</div><div class="line">        fmt.Print(nums[i], <span class="string">","</span>)</div><div class="line">    &#125;</div><div class="line">    fmt.Println(nums[n<span class="number">-1</span>])</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><p>多快好省地实现排序算法，本身也是学问。但这次我们不研究这个，直接使用 <code>sort</code> 包。</p>
<p>自定义类型想要排序，需要实现 <code>sort.Interface</code> 接口的一系列方法；基本类型则预先实现了对应的函数。对于 <code>string</code> 类型的升序排序，<code>sort</code> 包给我们提供了 <code>sort.Strings()</code> 。</p>
<p>另外，前面最后的输出代码，实现起来还是比较麻烦，而且存在一个 bug。借助字符串工具包里的 <code>strings.Join()</code>  函数，可以先拼接成目标字符串，再一口气输出，既简单又绕开了 bug：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 这次不再详细注释，有疑问请习惯查文档，或者参与讨论</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    n := <span class="built_in">len</span>(os.Args) - <span class="number">1</span></div><div class="line">    nums := <span class="built_in">make</span>([]<span class="keyword">string</span>, n)</div><div class="line">    <span class="built_in">copy</span>(nums, os.Args[<span class="number">1</span>:])</div><div class="line">    sort.Strings(nums)</div><div class="line">    fmt.Println(strings.Join(nums, <span class="string">","</span>))</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这时编译之后再执行程序，效果如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; gosort 133297 167834 123467 145683</div><div class="line">123467,133297,145683,167834</div></pre></td></tr></table></figure>
<p>通过调用标准库，5 行代码实现了我们阶段性的小目标。</p>
<p>下一期我们还是讨论这个程序，面对需求的变化，如何改善程序去支持更复杂的功能。</p>
<h2 id="思考题"><a href="#思考题" class="headerlink" title="思考题"></a>思考题</h2><ol>
<li>第一次改善后的程序里，输出的代码有什么 bug？</li>
<li><code>sort.Strings(nums)</code> 为什么没有返回值？字符串切片 <code>nums</code> 只是作为实参传给了排序函数，按理说切片本身发生了拷贝，为什么排序最后对 <code>nums</code> 生效了？</li>
</ol>
<hr>
<p><img src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" alt="知识共享 “署名-非商业性使用-相同方式共享” 4.0 (CC BY-NC-SA 4.0)”许可协议"><br>本文为本人原创，采用<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="external">知识共享 “署名-非商业性使用-相同方式共享” 4.0 (CC BY-NC-SA 4.0)”许可协议</a>进行许可。<br>本作品可自由复制、传播及基于本作品进行演绎创作。如有以上需要，请留言告知，在文章开头明显位置加上署名（Jayce Chant）、原链接及许可协议信息，并明确指出修改（如有），不得用于商业用途。谢谢合作。<br>请点击查看<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="external">协议</a>的中文摘要。</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://jaycechant.info/2020/golang-in-action-day-6/" data-id="cklfcilfj00609gxldjeom9wm" class="article-share-link" data-share="baidu">分享到</a>
      

      
        <a href="https://jaycechant.info/2020/golang-in-action-day-6/#disqus_thread" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/golang/">golang</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/three-things-to-do-when-you-hit-a-crossroads-translation/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">
        
          遇到十字路口，你要做的三件事（翻译）
        
      </div>
    </a>
  
  
    <a href="/2020/golang-in-action-day-5/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">Go 语言实战（5）：流程控制</div>
    </a>
  
</nav>

  
</article>


  <section id="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </section>
</section>
      
      <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Go-语言实战/">Go 语言实战</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/刷题/">刷题</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/科普/">科普</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/粤语/">粤语</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Algorithm/" style="font-size: 13.33px;">Algorithm</a> <a href="/tags/Anaconda/" style="font-size: 10px;">Anaconda</a> <a href="/tags/Android/" style="font-size: 11.67px;">Android</a> <a href="/tags/Android-sdk/" style="font-size: 10px;">Android-sdk</a> <a href="/tags/CentOS/" style="font-size: 10px;">CentOS</a> <a href="/tags/DNS/" style="font-size: 10px;">DNS</a> <a href="/tags/JCE/" style="font-size: 10px;">JCE</a> <a href="/tags/Java/" style="font-size: 11.67px;">Java</a> <a href="/tags/JavaMail/" style="font-size: 10px;">JavaMail</a> <a href="/tags/Jenkins/" style="font-size: 16.67px;">Jenkins</a> <a href="/tags/LeetCode/" style="font-size: 15px;">LeetCode</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Markdown/" style="font-size: 13.33px;">Markdown</a> <a href="/tags/Mathjax/" style="font-size: 10px;">Mathjax</a> <a href="/tags/OJ/" style="font-size: 10px;">OJ</a> <a href="/tags/Octopress/" style="font-size: 10px;">Octopress</a> <a href="/tags/OpenGrok/" style="font-size: 10px;">OpenGrok</a> <a href="/tags/Python/" style="font-size: 16.67px;">Python</a> <a href="/tags/Ruby/" style="font-size: 10px;">Ruby</a> <a href="/tags/Syncthing/" style="font-size: 10px;">Syncthing</a> <a href="/tags/TDD/" style="font-size: 10px;">TDD</a> <a href="/tags/Tomcat/" style="font-size: 10px;">Tomcat</a> <a href="/tags/Ubuntu/" style="font-size: 11.67px;">Ubuntu</a> <a href="/tags/algorithm/" style="font-size: 11.67px;">algorithm</a> <a href="/tags/aliyun/" style="font-size: 10px;">aliyun</a> <a href="/tags/app/" style="font-size: 10px;">app</a> <a href="/tags/blog/" style="font-size: 13.33px;">blog</a> <a href="/tags/byobu/" style="font-size: 11.67px;">byobu</a> <a href="/tags/ctags/" style="font-size: 10px;">ctags</a> <a href="/tags/dep/" style="font-size: 11.67px;">dep</a> <a href="/tags/document/" style="font-size: 10px;">document</a> <a href="/tags/dropbox/" style="font-size: 10px;">dropbox</a> <a href="/tags/file-system/" style="font-size: 10px;">file-system</a> <a href="/tags/flutter/" style="font-size: 10px;">flutter</a> <a href="/tags/git/" style="font-size: 11.67px;">git</a> <a href="/tags/glide/" style="font-size: 10px;">glide</a> <a href="/tags/golang/" style="font-size: 20px;">golang</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/how-to/" style="font-size: 16.67px;">how-to</a> <a href="/tags/jpg/" style="font-size: 10px;">jpg</a> <a href="/tags/json/" style="font-size: 11.67px;">json</a> <a href="/tags/maven/" style="font-size: 10px;">maven</a> <a href="/tags/mirror/" style="font-size: 10px;">mirror</a> <a href="/tags/netdisk/" style="font-size: 10px;">netdisk</a> <a href="/tags/node-js/" style="font-size: 11.67px;">node.js</a> <a href="/tags/nodePPT/" style="font-size: 11.67px;">nodePPT</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/pgyer/" style="font-size: 10px;">pgyer</a> <a href="/tags/pip/" style="font-size: 15px;">pip</a> <a href="/tags/png/" style="font-size: 10px;">png</a> <a href="/tags/practice/" style="font-size: 11.67px;">practice</a> <a href="/tags/presentation/" style="font-size: 11.67px;">presentation</a> <a href="/tags/review/" style="font-size: 10px;">review</a> <a href="/tags/screen/" style="font-size: 11.67px;">screen</a> <a href="/tags/service/" style="font-size: 10px;">service</a> <a href="/tags/skill/" style="font-size: 13.33px;">skill</a> <a href="/tags/smtp/" style="font-size: 10px;">smtp</a> <a href="/tags/software/" style="font-size: 10px;">software</a> <a href="/tags/solution-report/" style="font-size: 10px;">solution-report</a> <a href="/tags/supervisor/" style="font-size: 10px;">supervisor</a> <a href="/tags/thought/" style="font-size: 10px;">thought</a> <a href="/tags/trouble/" style="font-size: 18.33px;">trouble</a> <a href="/tags/unfinished/" style="font-size: 13.33px;">unfinished</a> <a href="/tags/virtualenv/" style="font-size: 10px;">virtualenv</a> <a href="/tags/vsftp/" style="font-size: 10px;">vsftp</a> <a href="/tags/why/" style="font-size: 11.67px;">why</a> <a href="/tags/写作/" style="font-size: 13.33px;">写作</a> <a href="/tags/动态规划/" style="font-size: 10px;">动态规划</a> <a href="/tags/安全/" style="font-size: 10px;">安全</a> <a href="/tags/数据结构/" style="font-size: 10px;">数据结构</a> <a href="/tags/翻译/" style="font-size: 13.33px;">翻译</a> <a href="/tags/语言表达/" style="font-size: 10px;">语言表达</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">四月 2012</a><span class="archive-list-count">5</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/time-is-up/">现在写，可能都来不及了...</a>
          </li>
        
          <li>
            <a href="/2020/memory-leak-caused-by-substrings-in-go/">Go 语言字符串子串引起的内存泄漏</a>
          </li>
        
          <li>
            <a href="/2020/golang-in-action-day-8/">Go 语言实战（8）：命令行（3）CLI 框架</a>
          </li>
        
          <li>
            <a href="/2020/suisuikang/">关于保险的两个追加话题之一：穗岁康</a>
          </li>
        
          <li>
            <a href="/2020/why-element-type-of-slice-cannot-be-converted-in-go/">答读者问：为什么 Go 里面不能把任意切片转换为 []interface{} ？</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="https://hexo.io/zh-cn/" target="_blank">Hexo主页</a>
          </li>
        
          <li>
            <a href="https://hexo.io/zh-cn/docs/" target="_blank">Hexo文档</a>
          </li>
        
          <li>
            <a href="https://github.com/xiangming/landscape-plus" target="_blank">landscape-plus项目主页</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Jayce Sigit Chant<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/list" class="mobile-nav-link">List</a>
  
    <a href="https://github.com/JayceChant" class="mobile-nav-link">Github</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
    <a href="/sitemap.xml" class="mobile-nav-link">Sitemap</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->

<script>
  var disqus_shortname = 'jaycetb';
  
  var disqus_url = 'https://jaycechant.info/2020/golang-in-action-day-6/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>window._bd_share_config={"common":{},"share":{"bdCustomStyle":"/css/bdshare.css"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];</script>

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>



<! -- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
                processEscapes: true
                    
}
  
        });
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
                  
}
    
        });
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Queue(function() {
            var all = MathJax.Hub.getAllJax(), i;
            for(i=0; i < all.length; i += 1) {
                            all[i].SourceElement().parentNode.className += ' has-jax';
                                    
            }
                
        });
</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<script src="/js/script.js"></script>

</div>
</body>
</html>
